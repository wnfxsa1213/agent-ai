# 增强版写作助手 (Enhanced Writing Assistant)

这是一个基于通用智能体框架开发的增强版写作助手，不仅具备强大的写作能力，还集成了向量数据库功能，能够智能利用用户提供的参考资料（如PDF、Word文档等），帮助创作出高质量、有深度、有依据的内容。

## 特色功能

相比基础版写作助手，增强版添加了以下核心功能：

1. **参考资料处理**：可加载PDF、Word、TXT等多种格式的文档，构建向量数据库
2. **语义搜索**：使用先进的向量嵌入技术，根据语义而非关键词匹配查找相关信息
3. **智能引用**：自动从参考资料中提取关键信息，生成规范的引用
4. **多文档整合**：可同时检索多个文档库中的信息，综合利用多来源知识

## 功能概览

### 1. 核心写作功能（原有功能）

- **创作规划**：生成大纲、文章结构建议
- **内容创作**：扩展章节、生成标题、摘要、关键词
- **文本优化**：润色文本、检查语法错误
- **参考资料**：生成参考文献、搜索相关资料
- **文件管理**：保存文章到文件

### 2. 参考资料处理功能（新增功能）

#### 文档加载与管理
- **加载单个文档** (`load_document`)：将PDF、Word等文档转化为向量数据库
- **批量加载文档** (`load_documents`)：处理整个目录的文档文件
- **列出数据库** (`list_reference_dbs`)：显示所有可用的参考资料数据库
- **删除数据库** (`delete_reference_db`)：移除不需要的参考资料数据库

#### 智能检索与利用
- **语义搜索** (`semantic_search`)：在特定数据库中进行语义搜索
- **多库搜索** (`reference_with_search`)：在多个数据库中同时搜索信息
- **带引用保存** (`save_with_references`)：保存带有参考资料引用的文章

## 安装要求

除了基础写作助手的依赖外，增强版写作助手还需要安装以下依赖库：

```bash
pip install langchain langchain-openai chromadb pypdf docx2txt tiktoken
```

这些库用于文档处理、向量嵌入和语义搜索功能。

## 使用示例

### 基本使用

```python
from agent_framework import Agent
from agent_framework.examples.enhanced_writing_assistant import main

# 直接运行增强版写作助手
main()

# 或者创建自定义的增强版写作助手实例
from agent_framework.examples.writing_assistant import *
from agent_framework.examples.reference_tools import *

agent = Agent(
    name="我的写作助手",
    description="自定义的增强版写作助手",
    model="gpt-4o",
    tools=[
        # 写作工具
        generate_outline.tool,
        expand_section.tool,
        polish_text.tool,
        # ...其他写作工具
        
        # 参考资料工具
        load_document.tool,
        semantic_search.tool,
        # ...其他参考资料工具
    ]
)

# 使用助手
response = agent.run("加载文档C:/资料/论文.pdf，然后在其中搜索关于人工智能的内容")
```

### 参考资料工作流

以下是一个完整的基于参考资料写作的工作流示例：

```python
# 1. 加载参考资料
agent.run("加载目录 C:/研究资料/AI伦理 创建数据库 ai_ethics_db")

# 2. 查看加载的数据库
agent.run("列出所有参考资料数据库")

# 3. 搜索相关内容
search_result = agent.run("在ai_ethics_db中搜索'人工智能隐私保护'")

# 4. 基于搜索结果生成大纲
outline = agent.run(f"""
根据以下参考资料生成一个关于"AI与隐私保护"的学术论文大纲:

{search_result}
""")

# 5. 扩展特定章节，引用参考资料
chapter = agent.run(f"""
扩展"AI与隐私保护"论文中的"数据匿名化技术"章节，
使用专业语气，详细长度，并引用参考资料中的相关内容。

参考内容：
{search_result}
""")

# 6. 保存带引用的文章
agent.run(f"""
将标题为"AI与隐私保护"的文章与以下参考资料一起保存为markdown格式:

文章内容：
{chapter}

参考资料：
["Smith, J. (2023). Privacy in the Age of AI.", "Johnson, A. et al. (2022). Anonymous Data Processing."]
""")
```

## 命令行交互界面

运行 `python enhanced_writing_assistant.py` 启动命令行交互界面：

```
《增强版写作助手》
======================================================================
一个集成了向量数据库功能的专业写作助手，可以智能利用参考资料

【支持的文章类型】
- blog: 博客文章
- academic: 学术论文
- news: 新闻报道
...

【主要功能】
1. 创作规划：生成大纲、文章结构建议
2. 内容创作：扩展章节、生成标题、摘要、关键词
3. 文本优化：润色文本、检查语法错误
4. 参考资料：生成参考文献、搜索相关资料
5. 文件管理：保存文章到文件
6. 参考资料处理：加载文档、构建向量数据库、语义搜索

【参考资料功能使用示例】
示例1: 加载文档 C:/我的资料/thesis.pdf
示例2: 加载目录 C:/我的资料/research_papers 创建数据库 我的论文资料
示例3: 列出所有参考资料数据库
示例4: 在'我的论文资料'数据库中搜索'人工智能伦理问题'
示例5: 根据参考资料生成一篇关于'AI伦理'的文章大纲

【命令】
- 输入 'help' 或 '帮助' 查看详细使用指南
- 输入 'reference-help' 查看参考资料功能使用指南
- 输入 'exit' 或 '退出' 结束程序
----------------------------------------------------------------------

请输入需求:
```

## 参考资料功能详解

| 功能 | 描述 | 主要参数 |
|------|------|----------|
| 加载单个文档 | 加载单个文档并构建向量数据库 | 文件路径、数据库名称、文本块大小、文本块重叠大小 |
| 加载目录文档 | 批量加载目录中的所有文档 | 目录路径、数据库名称、文件类型列表、是否递归处理子目录 |
| 列出数据库 | 显示所有可用的参考资料数据库 | 无 |
| 语义搜索 | 在特定数据库中搜索相关内容 | 查询文本、数据库名称、结果数量上限、最低相关度阈值 |
| 多库搜索 | 在多个数据库中同时搜索 | 查询文本、数据库名称列表、每库返回结果数 |
| 删除数据库 | 删除指定的参考资料数据库 | 数据库名称 |
| 带引用保存 | 保存带有参考资料引用的文章 | 标题、内容、参考资料列表、文件格式、保存目录 |

## 实际应用场景

1. **学术论文写作**：加载研究文献，自动引用相关研究，生成规范的参考文献列表
2. **技术文档创作**：导入API文档、技术规范，确保技术描述准确且有出处
3. **内容营销**：基于行业报告和市场数据，撰写有数据支撑的专业内容
4. **研究报告**：整合多个数据来源，生成全面且有根据的分析报告
5. **教学资料**：结合教材内容和学术资源，创建准确的教育内容

## 自定义与扩展

您可以通过以下方式自定义和扩展增强版写作助手：

1. **调整向量数据库参数**：修改文本块大小、重叠比例等参数，优化检索效果
2. **添加新的文档处理器**：支持更多文件格式，如HTML、EPUB等
3. **实现高级搜索功能**：添加基于关键词和语义的混合搜索
4. **集成其他AI模型**：使用特定领域的嵌入模型，提高专业领域的检索精度

## 注意事项

1. 向量数据库会占用一定的磁盘空间，处理大量或大型文档时需确保有足够存储空间
2. 初次加载大型文档可能需要较长时间，请耐心等待
3. 语义搜索需要联网调用OpenAI的嵌入API，请确保网络连接和API密钥可用
4. 处理非英文文档时，推荐使用支持多语言的嵌入模型 